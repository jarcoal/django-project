---
description: 
globs: 
alwaysApply: true
---
# Django Task Organization

New Tasks go in `app/tasks/` and must be registered in `__init__.py`.

## Do ✅

```python
# Good: tasks/email.py
from django.conf import settings
from app.celery import app
from app.utils.retryable_task import RetryableTask

@app.task(base=RetryableTask, queue=settings.WEBHOOK_QUEUE)
def handle_inbound_email(raw_email: str, project_id: int) -> None:
    # ... task implementation
    pass

# Good: tasks/__init__.py
from .email import handle_inbound_email

__all__ = ['handle_inbound_email']
```

## Don't ❌

```python
# Bad: Task defined in tasks.py
# tasks.py
from celery import shared_task

@shared_task
def handle_inbound_email(raw_email: str) -> None:
    pass

# Bad: Task not registered in __init__.py
# tasks/email.py
from app.celery import app

@app.task
def handle_inbound_email(raw_email: str) -> None:
    pass
```
app
## Guidelines

1. Place new tasks in `app/tasks/` directory
2. Each task module should be in its own file (e.g., `tasks/email.py`)
3. Register all tasks in `tasks/__init__.py`
4. Use `__all__` to explicitly define which tasks are exported
5. Use `@app.task` with appropriate base class and queue settings 